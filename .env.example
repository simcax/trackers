# Database Configuration
# ====================
# These environment variables are required for the trackers application
# to connect to the PostgreSQL database.

# PostgreSQL server host
# For local development with Docker: localhost
# For Docker Compose services: postgres-test
DB_HOST=localhost

# Database username
# Default PostgreSQL user in docker-compose.test.yml: postgres
DB_USER=postgres

# Database password
# Default PostgreSQL password in docker-compose.test.yml: postgres
DB_PASSWORD=postgres

# Database name
# The application will use this as the base database name
# Test database will automatically append "_test" (e.g., trackers_test)
DB_NAME=trackers


# Setup Instructions
# ==================

# 1. Copy this file to .env:
#    cp .env.example .env

# 2. Edit .env with your actual database credentials if different from defaults

# 3. Start the test database using Docker Compose:
#    docker compose -f docker-compose.test.yml up -d
#    
#    Or use the helper script:
#    ./scripts/test-db.sh start

# 4. Run tests:
#    pytest

# 5. Stop the test database when done:
#    docker compose -f docker-compose.test.yml down
#    
#    Or use the helper script:
#    ./scripts/test-db.sh stop


# Test Database Details
# =====================
# The test infrastructure automatically:
# - Creates a test database named {DB_NAME}_test (e.g., trackers_test)
# - Applies all schema definitions from SQLAlchemy models
# - Provides isolated database sessions for each test
# - Rolls back transactions after each test for clean state
# - Preserves the test database after test runs for inspection

# The test database is separate from your development database,
# ensuring tests never interfere with development data.


# Troubleshooting
# ===============

# If you see "MISSING REQUIRED ENVIRONMENT VARIABLES" error:
# - Ensure you've created a .env file from this template
# - Verify all four variables (DB_HOST, DB_USER, DB_PASSWORD, DB_NAME) are set
# - Check that the .env file is in the project root directory

# If you see connection errors:
# - Verify PostgreSQL is running: docker compose -f docker-compose.test.yml ps
# - Check the database is healthy: docker compose -f docker-compose.test.yml logs
# - Ensure port 5432 is not already in use by another PostgreSQL instance

# If you see permission errors:
# - Verify the database user has CREATE DATABASE privileges
# - For Docker setup, the default postgres user has all necessary privileges

# If tests fail with "database already exists" errors:
# - The test infrastructure handles this automatically by dropping and recreating
# - If issues persist, manually clean up: ./scripts/test-db.sh clean
